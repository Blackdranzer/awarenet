<?

//--------------------------------------------------------------------------------------------------
//	edit a block template
//--------------------------------------------------------------------------------------------------

	//----------------------------------------------------------------------------------------------
	// check permissions
	//----------------------------------------------------------------------------------------------
	if ('admin' != $user->role) { $page->do403(); } 

	if ((array_key_exists('module', $req->args)) AND ('' != $req->ref)) {
		//------------------------------------------------------------------------------------------
		// check the the block exists
		//------------------------------------------------------------------------------------------
		$module = $req->args['module'];
		$block = $req->ref;
		$fileName = $installPath . 'modules/' . $module . '/views/' .  $block . '.block.php';

		if (file_exists($fileName)) {
			//--------------------------------------------------------------------------------------
			//	render the page
			//--------------------------------------------------------------------------------------
			$page->load('modules/blocks/actions/edit.page.php');
			$page->blockArgs['refmodule'] = $req->args['module'];
			$page->blockArgs['refblock'] = $req->ref;
			$page->render();

		} else { $page->do404(); }	// block template file not found		

	} else {
		//------------------------------------------------------------------------------------------
		// module/block not provided
		//------------------------------------------------------------------------------------------
		$page->do404();

	}

?>
