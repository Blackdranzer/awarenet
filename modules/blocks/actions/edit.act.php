<?

//--------------------------------------------------------------------------------------------------
//	edit a block template
//--------------------------------------------------------------------------------------------------

	//----------------------------------------------------------------------------------------------
	// check permissions
	//----------------------------------------------------------------------------------------------
	if ($user->data['ofGroup'] != 'admin') { do403(); } 

	if ((array_key_exists('module', $request['args'])) AND ($request['ref'] != '')) {
		//------------------------------------------------------------------------------------------
		// check the the block exists
		//------------------------------------------------------------------------------------------
		$module = $request['args']['module'];
		$block = $request['ref'];
		$fileName = $installPath . 'modules/' . $module . '/views/' .  $block . '.block.php';

		if (file_exists($fileName)) {
			//--------------------------------------------------------------------------------------
			//	render the page
			//--------------------------------------------------------------------------------------
			$page->load($installPath . 'modules/blocks/actions/edit.page.php');
			$page->blockArgs['refmodule'] = $request['args']['module'];
			$page->blockArgs['refblock'] = $request['ref'];
			$page->render();

		} else { do404(); }	// block template file not found		

	} else {
		//------------------------------------------------------------------------------------------
		// module/block not provided
		//------------------------------------------------------------------------------------------
		do404();

	}

?>
