<?

//-------------------------------------------------------------------------------------------------
//	download all outstanding files from a peer
//-------------------------------------------------------------------------------------------------

	//---------------------------------------------------------------------------------------------
	//	auth
	//---------------------------------------------------------------------------------------------
	if ($user->data['ofGroup'] != 'admin') { do403(); }

	//---------------------------------------------------------------------------------------------
	//	get a list of all files from the images module and add to download queue
	//---------------------------------------------------------------------------------------------
	$list = expandBlocks("[[:images::listallfiles:]]", '');
	$list = explode("\n", $list);
	foreach($list as $fileName) {	
		if ( (trim($fileName) != '') && (file_exists($installPath . $fileName) == false) ) {
			//-------------------------------------------------------------------------------------
			// filename is valid and does not exist on this server
			//-------------------------------------------------------------------------------------
			syncRequestFile($fileName);
			//echo ">> " . $fileName . "<br/>\n";
		}
	}

	do302('sync/downloads/');	

?>
